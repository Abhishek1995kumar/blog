(()=>{"use strict";$(document).ready((function(){var a=$("#bloodDonorsTable").DataTable({processing:!0,serverSide:!0,searchDelay:500,language:{lengthMenu:"Show _MENU_"},order:[[6,"desc"]],ajax:{url:bloodDonorUrl},columnDefs:[{targets:[5],orderable:!1,className:"text-center text-nowrap",width:"8%"},{targets:[1],className:"text-right"},{targets:[6],visible:!1},{targets:"_all",defaultContent:"N/A",className:"text-start align-middle text-nowrap"}],columns:[{data:"name",name:"name"},{data:function(a){return'<span class="badge badge-light-info">'.concat(a.age,"</span>")},name:"age"},{data:function(a){return 1==a.gender?'<span class="badge badge-light-primary">Female</span>':'<span class="badge badge-light-success">Male</span>'},name:"gender"},{data:function(a){return'<span class="badge badge-light-danger">'.concat(a.blood_group,"</span>")},name:"blood_group"},{data:function(a){return a},render:function(a){return null===a.last_donate_date?"N/A":'<div class="badge badge-light">\n                    <div class="mb-2">'.concat(moment(a.last_donate_date).utc().format("LT"),"</div>\n                    <div>").concat(moment(a.last_donate_date).utc().format("Do MMM, Y"),"</div>\n                </div>")},name:"last_donate_date"},{data:function(a){var e=[{id:a.id}];return prepareTemplateRender(".modalActionTemplate",e)},name:"id"},{data:"created_at",name:"created_at"}]});handleSearchDatatable(a)})),$(document).on("submit","#addNewForm",(function(a){a.preventDefault();var e=jQuery(this).find("#btnSave");e.button("loading"),$.ajax({url:bloodDonorCreateUrl,type:"POST",data:$(this).serialize(),success:function(a){a.success&&(displaySuccessMessage(a.message),$("#addModal").modal("hide"),$("#bloodDonorsTable").DataTable().ajax.reload(null,!1))},error:function(a){printErrorMessage("#validationErrorsBox",a)},complete:function(){e.button("reset")}})})),$(document).on("submit","#editForm",(function(a){a.preventDefault();var e=jQuery(this).find("#btnEditSave");e.button("loading");var t=$("#bloodDonorId").val();$.ajax({url:bloodDonorUrl+"/"+t,type:"put",data:$(this).serialize(),success:function(a){a.success&&(displaySuccessMessage(a.message),$("#editModal").modal("hide"),$("#bloodDonorsTable").DataTable().ajax.reload(null,!1))},error:function(a){manageAjaxErrors(a)},complete:function(){e.button("reset")}})})),$("#addModal").on("hidden.bs.modal",(function(){resetModalForm("#addNewForm","#validationErrorsBox")})),$("#editModal").on("hidden.bs.modal",(function(){resetModalForm("#editForm","#editValidationErrorsBox")})),window.renderData=function(a){$.ajax({url:bloodDonorUrl+"/"+a+"/edit",type:"GET",success:function(a){if(a.success){var e=a.data;$("#bloodDonorId").val(e.id),$("#editName").val(e.name),$("#editAge").val(e.age),$("#male,#female").prop("checked",!1),1==e.gender?$("#female").prop("checked",!0):$("#male").prop("checked",!0),$("#editBloodGroup").val(e.blood_group),$("#editBloodGroup").trigger("change"),$("#editLastDonationDate").val(moment(e.last_donate_date).utc().format("YYYY-MM-DD HH:mm:ss")),$("#editModal").modal("show"),ajaxCallCompleted()}},error:function(a){manageAjaxErrors(a)}})},$(document).on("click",".edit-btn",(function(a){if(!ajaxCallIsRunning){ajaxCallInProgress();var e=$(a.currentTarget).data("id");renderData(e)}})),$(document).on("click",".delete-btn",(function(a){var e=$(a.currentTarget).data("id");deleteItem(bloodDonorUrl+"/"+e,"#bloodDonorsTable","Blood Donor")})),$(document).ready((function(){$("#bloodGroup").select2({width:"100%",dropdownParent:$("#addModal")}),$("#editBloodGroup").select2({width:"100%",dropdownParent:$("#editModal")});$("#lastDonationDate").flatpickr({enableTime:!0,defaultDate:new Date,maxDate:new Date,dateFormat:"Y-m-d H:i"}),$("#editLastDonationDate").flatpickr({enableTime:!0,maxDate:new Date,dateFormat:"Y-m-d H:i"})}))})();